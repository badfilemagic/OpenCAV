import unittest
import os, sys
sys.path.append("..\lib")
from sha2_req import Sha2ReqParser


class AESRespTest(unittest.TestCase):
    def test_1(self):
        msg = "c4e26c0f8c53f618bf0e0858de614831cc6ddf74262d7285d7b454bae6b6fa05934aafd3a3ee8833f8cc9b3b643c6ca7bf89a8c437f8168de806ca13adf29c22357bd82159eb373aac540ebb541ac6bc19b18c03bca849248ae7d5ec30356800d1fd51c25651ea74062fcba056033eb7026ef3f85c46f593e4dedd0f1a8746e99056807e4328892a2be438b21100bcdfa147456cc0d9012320734a4211f01e239a10cf1cc879fba546fbbfb82e18287e1fc4ea2790695519632e844ebd79d8f716b2a5668c4b2a2a7dfdc77c54546adaa36d4bf173ffd9c0d898f3fbc8295cad2cc5692238a6fd04f871b7c42cba6a3b56cbce9211a1755fa4380010d709928d06d0851973925c79e0dff9595e5511eb6065dcd1135a113df2961157951f62dfc95b6013e6182fd35dcff403912a4531e8c3de77212f95a3e83b9096a775b5eaa0ef62d8393f5e5896ca10896d43ef54166e3a4ce22ae9d9aeaee396b81371f7b113f32f1310d251b457b5b59ca7f89d13ed5a18ff52f5276d77741f6eff804e244f7be11c917105deff4b4dc35e465407c8a4a31fafa2d54d1fa9f97143c837222b62b7fdcc24be3d493a1a8d71c3c11a8882b5eb4ad62a752deceb6ae733fad33010765ec9d4c2f9bdebe49fe7552b72b45b150b2a7a6f0e29a4be01f1a8de5ee5eee9e68f675b39e3c473a4c8e6dc3ad4968c265777ed3f9c383add6b0e2cebd262d73e26c7ce25442e8e421c5d1a98719de2e4dab3e9310d1227a75c4f2da480d5070e96da66e76792ff21eca22eb412d7dfefba18ae0b04994d06cd5226af76b042fde78a6aa4d4568cea3f9d60b73fac4aecff8d83f6093574a3c5ff62343c5950b322bd218714e4fe451e36f7c98084ed86b2f9af1aa54e63254c3e285c5b3af9d94f5dd4b5aea21cd990553d115ec78e63da467b9e5f4ce3356af7bf4e5ab905177451cc592afab04f9de278b860ddf62b7f5b2fabc098bc7b28127033c1403b149b814e991153804e4dc5f1e50f2fed87a92013684f98b69e8d77833319366479cbd5a59dea14567fa9e6f0c1f1233b1f617d6efe94b59847a20f4075e90348ed0d35188e3da7f88ab82dbc749022a79aae5a8a9417572c1d6ec0ee22b90eaf196889ee9493732e1683839f257495faa0999fad5361e738c9f973d76112c161a4e4b970d672e0c2cb10cedffd23e2fcdb29342063f9cb85f24b11415b7a83253789ade67d65567a5369f8c523277375f066012beb676ddb416d8075387bbdc57a604e98b0f13d205396e799bf08ae2d8a58ef15133434025e66aabb1f9dd507147082cd98a0fd7a769d85a3fb4cfdec4f08e42805e787c1f03e755a386734b4aec132ce5df9fe516188b82afd7dc779e77dc9aae608d0e19ffdcb9cac614294ef5c47e42684a96cbf5f6a78ed22739dfbbf87e4e11f762b15ac93c7a313676e8048a7551bca6495362882d3f4c46b2033d7041e1bb5e164f753b52444060c0b088d3c69665298926eede8843aea16ca36cc2aa0bf517857f0f818fbb8c197343034ec6a2ca4ae2c11b584d3e61cdc62ada6e0b1f37ca5cba6a5a69427cc72afa044a19e98490c2bc4893e0720e325b23f6e0d9adfbdd087c1614636b8b00344ffc5424fcfc81c573170fe6a12c55980952b9ba4ad9c5f54ea35e02b93f4b4bdf6c0b7c3fca945780072ac42e14ce09556e5711482a1bbfac9275db9e120ece12c3be8424575ee55d99730d8b80023b92ba4773589554c410542a329cabd12774a41bd16d2b381b762e87274bd6888b3bc71954ee73f7af1468b9bc375529048f7d71e86cceb6566466c5a5e180c784db053b3a6c7e8aed1360c2dce0b67cd1cdc07f3d95ba6022a2b2bd1ddf2745c4db053b9864fd64eaa7bcc4294b38431baa0d82458a66ac0cbba2ebd3a73299a7c63788f36a793c444bdd3c05b963224ecec53994bd6c207109a7c08bec2b29ca272ca1efef8a77667a52a916cdbf80e78687e3afa12333fc2731d98ae0897c88784514c266a98cedbdad89b0fab5f5727bb63f0ac8347d0a9ef1a57556c6188f2421602f524f0326705e5c88b2eee67c18e0aa1aa5185228db47a2bfa179743ad532029b44f360cd5ce5afe2a8b2da70e8879363da3759d366a45fee430c1607e6177a7ac12f3c3ebdc3e2732eba47dd652ba98aba1a0aa6cba84b75ce067492e1124662296aebf72d8992aec75dc52e093d5ad3c758daff64c3e3eaa4f1265850d2e4c6102ef68316973efa0525c8ff5f4d05f3a44c4169dc77b7b16a4491c4afd9d43b07f3f26f238d55e96a9ac9add1db595eb39ce4529d34356e80895d647887a32563524617bedc65f15a355dd60b58c37997932a662199fb767a27dfb4257cc009c4b2881952f4fda6668debe45655b2c8a2f789f0f419686dc9b89f304129b97caead3ee08a677b7d21fcfa756d42c5e0681299afaf331ab8f1a41275560efde2839ac109cfb46de9ff1b1ff59aa06b45797ccfee9d6770ec8482efdfce9d1bdfd613b5019d6c43715050a2e1791f216c49ae933a5927097cf4cd7dec356481c9389081446defaab7e84659c582ff66c94b209a1f6d0242feb4fc433704f5de330da9cc5ecbcef20209547b1e42c1d9e1006b3b0a3389cbc66797e62cc7b17fa1d7c7eccd318ab7f45613ad582316c9580bf6fc87671df2786f18cd59f837e4aa296368fc39837b1330fc570fce6ed372c04c5513524f55994e076f2b10e9ab906504d7884e79a9d32c871ea18f2a76d5bfe3eb3a9f8e739d76dc523c9c5743093d34aeeddabdc2a8cb4c4ab9ffea22056d561569a96bcae99c100cfb15013988f47b558988d064287fa481b58b1e73666b0b6a2d0a57ca22003af5d2f567fd743d417207b341fcc6dc385a20db47d99d1b7c60012ce2ffcb65c5b370c7fc1d7f7a0f6ad4f492faf843602a984ae6c2fdf1418d629b9dea4a1f48bc40f75e07ef3d6dd67db733fd5157c47968648bde2daec358dde0d918129f2c76c02dde4b67e9c51b6e95b552567bcdcd3db2a7798086aa38ef7724e7d987f9797ab62d666e11adc023fa87c87c41f4ac64bfba23bb3b3ec403c921f7f34c284add4aabd76657a05b3a603b9e372cd18d99e6347b221f2970a77120b7047e41516435da1cd4fe15431e6141621baedce739b0c6ce59a4d2d566e9d1a36170cd33bc1248a55ea7952e5c7829a2ae4a7f4fb0c9b1cbc68ec358bead955baed63448215a781f57d6a863511f64de4382513dbb7bb5c1fd2f83710b36ec3e41011f254098d8d954fdc798a8b173838fe8cb27a641236f61f99bc4f91056d9dca3d651a637eb71da9f6b14dff8e620e7d075a40dd48b12998f64baf4c4659cb610f233aec240676d3e0b8e43302d44ffebb9295e906d5a085386c98abd891571eb0b61e6c24828615c316b9ef1c94e1c9d3e2e14ff4ab442e86a77278641d2a4948a62cab293336b7c75132fd84acae2675d28cd8b93afbda0985a67991032b2afe79ce70d9226f0013f3b924e1239d5dcaebfe4cfd8baed2e98d9a77084d4108fbb96b84dc56173ad084b52bdb0295b5f9b4a0736aa4465f4d48b7397003562d67ed6ab0dbd717ab258a8edb1b5080772ab6d814a68fa9c75d3c6589722b51df699e35ba7eae589b3b8fabfc491545ec87770ff95954c15243f30d2db6cf19672953336a6ce2c154391a76560d5acc593581aee82cf9744a24f515eee3f6980dd094cc8a4e7b391d48b456b00d26fd095f5c1baac688acf52bc8e794a1a9b51886ea68e0cb82aa3d90e3b3d3f481c0432b8ec007d108509d7df6e9e79aef58d272db6f368cfefbfd3832f6886873fd4ec1a104c6f2824888450785af73d06981bdf1495238f714a56926859511059c734a1d4eb1d3fd7cfea98122b3d754d16e8eb45ffc7875dd7d4a49c9c2993e85faee88088e1c81d449d1ee27bc6c8476e10eab17fef4813ecc04222ad9a527a02bd46c9926751738b0e6d5fe92da674121655eda1f53221fdcbe3911a0e0c6d64d2550694184c5907a10bf0efdca051a78ba5511263e6168f3a117e4e1ef250daa08bde0a7f495c4f07633bfc5e467ea2c351922dc5c44015ad5430c627d4c2e88a63a661f6b8fbc5a41b979b1cf9497860031770956d6d2598145f2ec30412230274f637291ba600098d9a48a34940bce40257675d31cc337cda6fd46b00ecfeab2843f68101e9929a41ca818ba702c4c207e89e77c20bd3ee2ed943aa6bb1ffe6f6262c98dc34d1e8d09ee230a2fe448c6c31728f9e9a6b4e8a2218eba4ef9b38770345db3b265287a29dc73cbd91a095a7c8801f17f68e2064e0b0b93d1445222361eec27f2ca8d9302dbcfa677b6d8053143370cebe9106578ba79da4bea23673d863d948b6295021e540143109ffdee6bb295f33413862da896a036c5d26e7f0cd519a086178aec05adcf49acbfc03fb13ce24e62cc8b856607475046e47b922c7448f3ead0b27c3d50026153fd681d8c49e5c47efe68953b7538cfd60891c723c99236bf7557d750a362320e413fb2834167fe8e906686ae48395c7d26fa467b3ebf110dedbf28c610b665e4738b261e8d30a49d6acb8048e8139f4426fc38bb3a962bdd22329525fdc8a1de7c95a1e593085db074dfaa8fbd8e3f32f0e0c56c25e02d36fbfa46f7d45e8f0342a54a61bcb7d1d196ec2d0d3071e5506dee14156665be21605e64c3fc41d65bae0349197004a907b838314aa78638a5836d4e3e67ed87a539a51712dd391feea8f6c79518b98d5bc20cddcd8b93e1391ba79a708f4030ca6e18866bdf0d12c519c7ec5e1a9c24d39cb0591e456187141ee2213146256098e8ffda566a8756e7e7bfdffbe076177a2e6ccec53bb8d33f72670a0cf466bf188da23a5be66d945cfc24c9f4d00e0d556188644ad75f6dc1017e7e8601c9f6514648cf03bb88732d3e3ed1d2542eaf6e1b4b42368020fca2b16ea529d617ad4bfc3ac1d551a09c619757201cd39ca5cc45ff91119dc128ea6c81a67cd9178b0f95c1375a117db600eeb5dd5ab5219677c8ea7861980b9ba219fdaa07739339a4fb23591861e66a132aa1311561852b788a5420b0d8c6fad2a02bd8530c515f1214a85099aaa460a0356344d341900bd67587b085c5baf080e95359e70d1ba462ca9a446555803fb2f6433d1fbc0ade9970ca5169c7ae23b6dbbd544bdcb7b09b033f5c02c83fb04e5589447e3aba4eca62642be3466c3b7b60b0f208e3ed2cc5a9e1c1fa6dac5a7e3a7c837a2369016f359e657baabae1d85f765ba58987c0e9a3c69bd5ab8ee6498d651f9ae0df9f93d0c028b95b61bdd3c155b6aa354b130ed9361119e9acfbb8368c4366d7e4d13b1b129b26c22976776c962ba05103ce3c337b4b5091cf42d11e39156771403f71fedbe74945d9b4c94980e40e4475987b99dc72010abf629e2bb4bd2416ba903c616533aa4d3b21d3405d067c766a1ad4f3a0aeb5bc440427464464262f1c6ca52cf6a8d24315639c3a73bc724fa9fc4e291026f30f26d073583332f3222c7db247d76e488d30222c1d0c2c7937fce5f2237403436b2c6d8a47c74e1559b3686d9a50ac949554078cd36e7e1896297dc7ca146c2d38208474fd49e1143a78d8de0ea88a3fc148b9c342e1dbd8d4f96dd504378a3adec8bc39600012762f45730c892931d07bd6e1d954af6b4059345d24ba2685f1c5ecbee25a360ac59fe0e1fff419c9cf2ac427d7ef1e55d88da2f4bdd52a84db55563277d231f088f212cbbf38c179c535db32c4fd78c228d90adba73b89af7ef7cdbefeaf3bed488fa3d9553b696a3906e3aba86503d9b9a336baead68b2f6411180d81db9a298ce05bb2c8e759c4b304a4398b0f08c31254ec388f8c7a2c150d00c5073d96cbdc4c02ff2023d8aebb97e68576e3cea7bb55f5fd9c479ccd18514d8f99bd79fcc03b5f6765d62f50da27703770c99fae3d0d19b21cee3b3bf447c7123e4389e3c1153b93a0eaa7d3971c0bf682a9c1ff1fe31fff14699d9e345535f7feb710a966435e2ad946865f7bdf7f6ab36b7dc4e941d18b8ea00a1d5de561e5e1015475382b90d516d2141b0dd6943c0bf71b22248ef5ff917bcce0f95e1185f00a9e70be36993c61769b30d56a11149235e3435731540226e22a108f280e7f32b835c180cc4006c11a61c65b03c099510e1d4f0a94b63d54bd6bd5a8ab207ab0f4639206564edc3fa6af03280a67744f68106dc51ee35723f4d856cb4e0e1e70a76e08d93a8c65e102cd12c3e5cf4d942d05c61137a2f99b6fb9bc807ca2147cb79f4d80e2bf4ab1170319b4fec0ca294344827547bccbc516562e509aa204dc0e3e8983b4b232b7cb994184bc0296159415c87ab6fa74a8d2f6d5c111d795969293e36b1a2cc6fa07d6b1ba865c576006c0c0a6ed229d4c89e2d95d490970b42de584be7bf4ae82b40492dec697b613838c948452fcedba246361acaa003d3dc67e94073fd39157b8690b78e37b5a35f2c369994e520df98cbf95359d83a33a44a43acbcd911782fd4d451145d0ecce3aab6a6f4aeaa411a73e9e80885c4ab291a09e948ff6e90a69fa6730545e13e7458cbc8dac8d5b0b5f2aa415d451dbad94bae9e9ecc9aff7e6b79a5e78ed7886fab08a7bdd03daee9bc9ce7dea2bfe34353943534cd410515bcb06221944c2b6415efac24614c8c24365453f30b15a4d5c67d35917ddb521af7fd2049f2c9a7c02dd34e94e88ce903e4431e310ad9803f18ac283b6ad466fcc1b278c726da8e2257661785c26935f76aeb9f1f1e55f5bdceb37598f0c6a4199e72c43facf93ef9371a9f7dab7c037d2ed05f23b23585f05d25b640bc2c9a1fe2a0ab09f1a04ab321633ef2f03fc203a483e6e552d2b165586562b92960c96e32ee85cca15a21febac28e8c3d2f02396068ceba9cb7f88b2514f368d51db283039efcde1891652a77daf68feec4347ce7016f39ec7fcbe05796e0e62bbdd60cd94468d4e3e074c4ccff1f948199e95cbce050d9ce84bbf3747dd3a7b9cbb45a387172477fc1e16c3eb16220920a913736880c20bf514932e03c1423ebc1de098598718c68b03b7f519456ca9ca0bcbaf85b09854b7fe43d4f545af15e3a9379554c0f3a1b25d37c9a1a65d90df6dc5686ebd19ddf6b2d610658e0867d80a5583beea3c723ad49f26ca627f26277608846ccecd0f79d854c99ac7d59c64e63f48e02c7ca0ec11f6f6dda15ad469cf9cedc50b3b520a17c6e9dd169f1c4fe6ffce02af3a938ebc4420228a74006f1f8989c19deb0f6f17335776a3ec4e61b19bfb6c9bfeb3e87d928ce1465714ff0fd742aaac65ac7181a3fbad97479c61f01eb965175168c4fae72262fc8b76e2478ffec65f3293d8fd1ebdc91a356d194a8def364bb91ae8de4bcaecd59690e06eb9a75fdfd92a6c32ad851453402a4f68f2852860c0311dcfc66cc9f902c8c02c5b24bb54e2dbf5c9573bd46bef39ccf15462817eee152b7561f03f8f57884c2b7f5d22e5d60d3a6925c7528aca03588ebc7089ccca2eda7a233e97c01b374a102c3adeba3b2704bb1d11d6d65af0bae731968a73dce5f283153e19b3d83c83866ba336fc9c931b674a02a87a2669bca3bbbcca9baca03a3b3dd90c911501bf33438071d37eb84714b1800f9cb7d4246a62ca926ac3c87b47a5f5ba815bedc5bfbcb9d8666bfe506a5c745565939abbe62fa92a0ba8c67d52557b69ac31685fd3de36b3deeacdfd1352c7c0fc442449bd293fdaa4e3000802535462391fda5317b2e04a62848d17b49b5f998952d996975975ea5efde0e4ffa966ed51adab6a323f9de41bbfa666f8402627364320691dc534a1607dcdd8f25f9b511c64446ccd8d56ca312681b2844803b429a1638cf6776249d3eb2fae837bdad8c1cb0b218fa5f445cb3e84c303bbdd868af309c5cb77e828ded06d2c59070ac8696b6951218e5d9b119118611ba19ee682c27add44cbaf86aab2f11b1d0a156a3bcac7c32a507b142ca6a65374032d1c39951d9c087d9ead5e1c2242768de20660728b4053f434fa44059462b7e87270d6f45cc9c0959ce42393686b0d9759e4ffeb1f904481729380374b568c59552a81679e2e1319937221a12b5c8930624b41bbe97ba4ff1c2909c334f79a5dbe9164774c91aa136aa07fcdd3de9460e5854e6c53c91b771a020731b60c8afc95eea4abccbb2c8a09b6669fc8b9d330cad84d86c34153f05466a10a385f033ec2896c8c8774428758fcfda073b5f0a7f98d668fa3acf172b19fffd424b6ae2c2daae2a1e58394113eb96d573a9a93ce5bebc3115ad2a0051cf44a1ae1da33cdbf992e724fb2c930a637dd4d862f63abd63c8993507b06b27aacaa61d793392a5e9d79872bc78aec75bc7608c03d094953c6e39eed6fcb80b41046336ea86849f300eb69e28b7e4e94915f124e8c2cadbbd3f7b999759878b26847170ee36a346708ab9fddc64e5debfec1f39ae475e1f4a9ed6cbc5715a05cfcd4961f0ae4f3a0fee2b18340a122624ac4310a0d8cece890ee3fbedbe9029a13163709e6818c882ab7283bc020a3e2bf8f5608ce18d67dd222bb07cabca655f63582343fe60906d3538a6f1073ea51a34beafbf1c2a79db6b067ffeb389273ee58ff09ddbe710142dd6286f641ff993f1f734b3c31682f83c0cb0f0803d0de41a737ee87afcd63c07e35e83b32e8a0db347b5f780d211b827c709de7c5687c374bb14c07612413935e8dfca7efaf50bfb289a16d00d849fb0add13512760371a6cf58c237e7ef903a4f12c01205c8f32c02678e2b097a135929ad70ed0c2f630318c14a4abe4fd5a79eae0136df5477d86d84ca0c5650a7a3d3053e66a96a1c3c3fd4e51925c07de04ff7ea37c845fe92d2a8670e84b6f103226eda19ae21f194ad0a0f4dbf1ffd96eb86f7af810bfbcdda18c18c14fb5409a040f060ab05a7aed8e74532ea8cd91de9d1b6087a24f3ebdc7c760f77cc5529d5320df62073930d4be3138318b594f7d37ea1cd141f7b9f6239f1233d7878e"
        p = Sha2ReqParser()
        p.ingest("SHA256LongMsg.fax")
        self.assertEqual(51200, p.ops[-1].msglen)
        self.assertEqual(msg, p.ops[-1].msg)